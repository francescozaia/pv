$(document).ready(function(){let e=function(){$("#articolo").prop("disabled",!0),$("#ch").prop("disabled",!0),$("#yes").empty(),$("#no").empty(),$("#res").empty()},t=function(){$("#articolo").prop("disabled",!1),$("#ch").prop("disabled",!1)};e();let n=document.querySelector(".toastOk"),r=document.querySelector(".toastNo"),a=new bootstrap.Toast(n),i=new bootstrap.Toast(r),o=null,l=getPV(),d=[];for(var p in l){var s=l[p].id+" AL(I|\xcc|I'|IPER) "+l[p].pv;-1===d.indexOf(s)?d.push(s):console.log(s+"item already exists")}let c=RegExp("("+d.join("|")+")","gmi"),f=function(e,t){var n=document.createElement("div");n.innerHTML=t.trim();var r="";for(let a of n.querySelectorAll("td"))if($("#ch")[0].checked){if(a.textContent==e){var i=$(a),o=i.parents("tr");o.prepend("<td><b>"+i.parents("tr").parents("table").prevUntil("table").contents()[0].data+"</b></td>"),r+=o[0].outerHTML}}else if(a.textContent.includes(e)){var i=$(a),o=i.parents("tr");o.prepend("<td><b>"+i.parents("tr").parents("table").prevUntil("table").contents()[0].data+"</b></td>"),r+=o[0].outerHTML}document.getElementById("res").innerHTML="<table>"+r+"</table>"};document.addEventListener("paste",function(n){n.preventDefault(),o=n.clipboardData.getData("text/html");let r=RegExp("A: VENETA PESCA SRL","gmi");if(o.match(r))a.show(),t();else{i.show(),e();return}let d=o.match(c),p=d.filter(function(e,t,n){return n.indexOf(e)==t});var s=l.filter(function(e){return!p.find(t=>t.includes(e.id))}).map(e=>e.id+" "+e.pv);document.getElementById("yes").innerHTML=p.join("<br/>"),document.getElementById("no").innerHTML=s.join("<br/>")}),$("#articolo").on("keypress",function(e){"Enter"===e.key&&(e.preventDefault(),$("#btn").click())}),$("#btn").on("click",function(e){f($("#articolo").val().toUpperCase(),o)})});